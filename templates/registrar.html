{% extends "base.html" %}

{% block conteudo %}
<h1>Registrar Venda</h1>

<form method="post">

    <label>
        Cliente:
        <input type="text" name="cliente" required>
    </label>
    <br><br>

    {% if tipo == "admin" %}
    <label>
        Barbeiro:
        <select name="barbeiro" required>
            <option value="mairon">Mairon</option>
            <option value="vini">Vini</option>
            <option value="artur">Artur</option>
        </select>
    </label>
    <br><br>
    {% endif %}

    <label>
        Cabelo:
        <input type="number" step="0.01" min="0" name="cabelo" value="0">
    </label>
    <br><br>

    <label>
        Barba:
        <input type="number" step="0.01" min="0" name="barba" value="0">
    </label>
    <br><br>

    <label>
        Sobrancelha:
        <input type="number" step="0.01" min="0" name="sobrancelha" value="0">
    </label>
    <br><br>

    <label>
        Produto:
        <select name="produto_nome" id="produto_nome">
            <option value="">(Nenhum)</option>
            <option value="Gel de cabelo">Gel de cabelo</option>
            <option value="Espuma de barbear">Espuma de barbear</option>
            <option value="Xampu">Xampu</option>
        </select>
    </label>

    <label>
        Valor do produto:
        <input type="number" step="0.01" min="0" name="produto_valor" id="produto_valor" value="0" disabled>
    </label>
    <br><br>

    <label>
        Desconto:
        <input type="number" step="0.01" min="0" name="desconto" value="0">
    </label>
    <br><br>

    <button type="submit">Registrar</button>

</form>

<br>
<a href="/historico" class="button">Ver Histórico</a>

<script>
  const produtoSelect = document.getElementById("produto_nome");
  const produtoValor = document.getElementById("produto_valor");

  function atualizarProdutoValor() {
    const temProduto = produtoSelect.value.trim() !== "";
    if (!temProduto) {
      produtoValor.value = "0";
      produtoValor.disabled = true;
    } else {
      produtoValor.disabled = false;
      produtoValor.focus();
    }
  }

  produtoSelect.addEventListener("change", atualizarProdutoValor);

  // ao carregar a página (garante estado correto)
  atualizarProdutoValor();
</script>

{% endblock %}
